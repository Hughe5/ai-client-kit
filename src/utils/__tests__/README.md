# 单元测试说明

## 测试框架

本项目使用 [Vitest](https://vitest.dev/) 作为测试框架，它与 Vite 项目完美集成。

## 运行测试

```bash
# 运行所有测试
npm run test:run

# 监听模式运行测试（开发时推荐）
npm run test
```

## 测试文件结构

```
src/utils/__tests__/
├── time.test.ts          # parseRelativeDate 函数的单元测试
└── README.md            # 本说明文件
```

## parseRelativeDate 函数测试覆盖

### 测试场景

1. **基本日期解析**
   - 中文日期格式：`2024年1月20日`
   - ISO 日期格式：`2024-01-20`
   - 带时间的日期：`2024年1月20日下午3点`

2. **相对日期解析**
   - 今天、明天、后天
   - 大后天、大大后天（特殊预处理）
   - 昨天、前天

3. **周相关日期解析**
   - 本周一至本周日
   - 下周相关日期
   - 带时间的周日期

4. **月份和年份相关**
   - 下个月、上个月
   - 明年、去年
   - 具体月份日期

5. **特殊格式处理**
   - 带空格的输入
   - 边界情况（月末、年末）

6. **错误处理**
   - 无法解析的输入
   - 空字符串
   - 无效格式

### 测试特点

- 使用 `vi.useFakeTimers()` 模拟固定时间，确保测试结果一致
- 测试覆盖了 `preprocess` 函数的特殊处理逻辑
- 验证了 `chrono-node` 库的中文日期解析能力
- 测试了边界情况和错误处理

## 添加新测试

在添加新的测试用例时，请遵循以下原则：

1. 使用描述性的测试名称
2. 按功能分组测试用例
3. 测试正常情况和边界情况
4. 确保测试的可重复性（使用模拟时间）
